<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="Can I rely on the Web Platform features to build my app? An overview of the device integration HTML5 APIs" name=description> <meta content="width=device-width,initial-scale=1" name=viewport> <base href=/ > <link href=https://fonts.gstatic.com/s/sourcesanspro/v13/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7lujVj9w.woff2 rel=preload type=font/woff2 as=font crossorigin=anonymous> <link href=https://fonts.gstatic.com/s/sourcesanspro/v13/6xKydSBYKcSV-LCoeQqfX1RYOo3ig4vwlxdu3cOWxw.woff2 rel=preload type=font/woff2 as=font crossorigin=anonymous> <link href=/Material-Design-Icons.woff rel=preload type=font/woff2 as=font crossorigin=anonymous> <style>@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:local('Source Sans Pro Regular'),local('SourceSansPro-Regular'),url(https://fonts.gstatic.com/s/sourcesanspro/v13/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7lujVj9w.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:700;font-display:swap;src:local('Source Sans Pro Bold'),local('SourceSansPro-Bold'),url(https://fonts.gstatic.com/s/sourcesanspro/v13/6xKydSBYKcSV-LCoeQqfX1RYOo3ig4vwlxdu3cOWxw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:"Material Design Icons";src:url(/Material-Design-Icons.woff) format("woff");font-weight:400;font-style:normal}</style> <link href=icon-76x76.png rel=apple-touch-icon sizes="60x60 72x72 76x76"> <link href=icon-120x120.png rel=apple-touch-icon sizes="114x114 120x120"> <link href=icon-144x144.png rel=apple-touch-icon sizes=144x144> <link href=icon-152x152.png rel=apple-touch-icon sizes=152x152> <link href=icon-180x180.png rel=apple-touch-icon sizes="167x167 180x180"> <link href=icon-32x32.png rel=icon sizes="16x16 32x32" type=image/png> <link href=icon-96x96.png rel=icon sizes=96x96 type=image/png> <link href=icon-192x192.png rel=icon sizes=192x192 type=image/png> <link href=manifest.json rel=manifest> <link href=client/main.83641940.css rel=stylesheet><link href=client/[slug].ce18d845.css rel=stylesheet><link href=client/Article.5a7d336b.css rel=stylesheet><link href=client/prism.7976db51.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>What Web Can Do Today: How to use Geolocation API with Promises</title> <meta content="What Web Can Do Today: How to use Geolocation API with Promises" property=og:title> <meta content="Geolocation API is definitely one of the best known device integration APIs we have on the web, both thanks its usefulness as well as its age. It lets the apps gain access to the user's location, expressed as geo-coordinates and subscribe to its changes. The possible usages range from location-based content filtering through mapping services to city games." property=og:description> <meta content=https://whatwebcando.today//articles/use-geolocation-api-promises/ property=og:url> <meta content=https://whatwebcando.today//articleimgs/beige-map.pexels.jpg property=og:image> <meta content="What Web Can Do Today: How to use Geolocation API with Promises" name=twitter:title> <meta content="Geolocation API is definitely one of the best known device integration APIs we have on the web, both thanks its usefulness as well as its age. It lets the apps gain access to the user's location, expressed as geo-coordinates and subscribe to its changes. The possible usages range from location-based content filtering through mapping services to city games." name=twitter:description> <meta content=https://whatwebcando.today//articleimgs/beige-map.pexels.jpg name=twitter:image><noscript id=sapper-head-end></noscript> <meta content=yes name=apple-mobile-web-app-capable> <meta content=yes name=mobile-web-app-capable> <meta content="What Web Can Do Today" name=application-name> <meta content="What Web Can Do" name=apple-mobile-web-app-title> <meta content=https://whatwebcando.today/icon-144x144.png name=msapplication-TileImage> <meta content=#ffffff name=theme-color> <meta content=#ffffff name=msapplication-navbutton-color> <meta content=black-translucent name=apple-mobile-web-app-status-bar-style> <meta content=/ name=msapplication-starturl> <meta content=website property=og:type> <meta content=WhatWebCanDo property=og:site_name> <meta content=summary name=twitter:card> <meta content=@WhatWebCanDo name=twitter:site> <meta content="AodJP6VzyH9zQqSi558VIXMDL7ElDBm3rY6IiSz2KRZ6ogLxtTCwBItsHBqyX1KURSLf6kNfFG4seIDiRKL77QAAAABSeyJvcmlnaW4iOiJodHRwczovL3doYXR3ZWJjYW5kby50b2RheTo0NDMiLCJmZWF0dXJlIjoiV2ViTkZDIiwiZXhwaXJ5IjoxNTgyNzI1NzAyfQ==" http-equiv=origin-trial> <meta content=AqnI8DMpa55imS/qK7qE73uRgm1X+UdZ7rbInxtM7F8zTgfm9e+E0tcY0KmI+Mm7FfAosKU5cqMN+8sL7COcMAsAAABUeyJvcmlnaW4iOiJodHRwczovL3doYXR3ZWJjYW5kby50b2RheTo0NDMiLCJmZWF0dXJlIjoiV2FrZUxvY2siLCJleHBpcnkiOjE1ODI3ODUzMjJ9 http-equiv=origin-trial> <meta content=AokzD/SJeJfcKJARUtujICN14urOGYKGGlHJWE2Aixopd5YQcdCwchsqcwS84XJSX6PJTkMuabIcE1ZRZxuMzgEAAABXeyJvcmlnaW4iOiJodHRwczovL3doYXR3ZWJjYW5kby50b2RheTo0NDMiLCJmZWF0dXJlIjoiU21zUmVjZWl2ZXIiLCJleHBpcnkiOjE1ODM3NzQwODl9 http-equiv=origin-trial> </head> <body> <div id=sapper> <header class="svelte-1fz80hk text-center"> <nav> <ul class=svelte-1fz80hk> <li class=svelte-1fz80hk><a href=. class=svelte-1fz80hk>Features</a></li> <li class=svelte-1fz80hk><a href=/articles/ class="svelte-1fz80hk selected">Articles</a></li> <li class=svelte-1fz80hk><a href=https://adambar.pl/#services class=svelte-1fz80hk rel=noopener target=_blank>Services</a></li> <li class=svelte-1fz80hk><a href=https://adambar.pl/#workshops class=svelte-1fz80hk rel=noopener target=_blank>Trainings</a></li> </ul> </nav> <div class="svelte-1fz80hk title-container"> <h1 class=svelte-1fz80hk>What Web Can Do Today?</h1> <p class=svelte-1fz80hk>Can I rely on the Web Platform features to build my app?</p> <p class=svelte-1fz80hk>An overview of the device integration HTML5 APIs</p> </div> </header> <div class="svelte-nzu3si container"> <main class=svelte-nzu3si> <nav aria-label=breadcrumbs class=breadcrumb> <ul> <li><a href=/ >Features</a></li> <li><a href=/articles/ >Articles</a></li> <li class=is-active><a href=/articles/use-geolocation-api-promises/ aria-current=page>How to use Geolocation API with Promises</a></li> </ul> </nav> <h1>How to use Geolocation API with Promises</h1> <div class="svelte-nzu3si content language-javascript"> <p><a href=https://whatwebcando.today/geolocation.html>Geolocation API</a> is definitely one of the best known device integration APIs we have on the web, both thanks its usefulness as well as its age. It lets the apps gain access to the user's location, expressed as geo-coordinates and subscribe to its changes. The possible usages range from location-based content filtering through mapping services to city games.</p> <p><img alt="How to use Geolocation API with Promises" src=/articleimgs/beige-map.pexels.jpg></p> <p>The first specs were created <a href=https://www.w3.org/TR/2008/WD-geolocation-API-20081222/#geolocation_interface>around 2008</a> and implemented by the browsers as early as 2009. The support ranges back to Internet Explorer 9 and Safari 5. Most of the API remains unchanged since then, and it can be felt nowadays, as its design even predates <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises>Promises</a> – the only way APIs on the Web platform handle asynchronicity these days. Geolocation API uses almost forgotten pattern of callbacks to handle its asynchronicity – so for developers used to Promise chains it might not be obvious how to make it work together with Promise-based APIs.</p> <p>Fortunately, converting callback-based Geolocation API into Promise-based one requires only a simple wrapper, here in TypeScript version for type safety:</p> <pre><code>function getPosition(options?: PositionOptions): Promise&lt;Position> {
    return new Promise((resolve, reject) => 
        navigator.geolocation.getCurrentPosition(resolve, reject, options)
    );
}</code></pre><p>Now we can use this version of Geolocation API with Promise chains. Its only parameter is now the optional <a href=https://developer.mozilla.org/en-US/docs/Web/API/PositionOptions><code>options</code> parameter</a>, callbacks are replaced by Promise resolved or rejected value:</p> <pre><code>getPosition(options)
  .then((position) => {
    console.log(position);
  })
  .catch((err) => {
    console.error(err.message);
  });</code></pre><p>It can also be used with <code>async</code>/<code>await</code>, as it's only a syntactic sugar on top of Promises:</p> <pre><code>try {
    const position = await getPosition(options);
    console.log(position);
} catch (err) {
    console.error(err.message);
}</code></pre><p>This async block is equivalent to the pure Promise version above.</p> <p>Apparently, this simple Promise-based wrapper for Geolocation API was also released as at least <a href="https://www.npmjs.com/search?q=geolocation%20promise">several NPM packages</a>, if this is the way you prefer to import the code, although these three lines don't seem to justify adding next dependency to our project.</p> </div> <div class="svelte-nzu3si author"><p><a href=https://adambar.pl>Adam Bar</a></p> </div> </main> <aside class=svelte-nzu3si> <h2 class=svelte-nzu3si>Advertisement</h2> <div class=ad> <script async id=_carbonads_js src="//cdn.carbonads.com/carbon.js?serve=CK7DT23L&placement=whatwebcandotoday"></script> </div> <h2 class=svelte-nzu3si>See also</h2> <div class="svelte-1itfw3h article"> <a href=/articles/progressive-web-apps-standard-or-buzzword/ class=svelte-1itfw3h rel=prefetch> <figure> <img alt="Progressive Web Apps – standard or buzzword?" src=/articleimgs/adult-books-business-coffee.pexels.jpg class=svelte-1itfw3h loading=lazy> <figcaption class=svelte-1itfw3h>PWA, Service Worker</figcaption> </figure> <div class="svelte-1itfw3h description"> <h3 class=svelte-1itfw3h>Progressive Web Apps – standard or buzzword?</h3> <p>Progressive Web Apps (PWA) is modern way to build applications, including mobile ones, using purely web technologies and relying purely on the capabilities and strengths the Web platform. Historically, it was the lack of these capabilities on the Web that caused the boom of the mobile apps, using so-called "native" (platform-specific) development approaches.</p> </div> </a> </div><div class="svelte-1itfw3h article"> <a href=/articles/use-chrome-dev-tools-switches/ class=svelte-1itfw3h rel=prefetch> <figure> <img alt="How to use Chrome Dev Tools Service Worker switches" src=/articleimgs/analogue-console-control.pexels.jpg class=svelte-1itfw3h loading=lazy> <figcaption class=svelte-1itfw3h>PWA, Service Worker</figcaption> </figure> <div class="svelte-1itfw3h description"> <h3 class=svelte-1itfw3h>How to use Chrome Dev Tools Service Worker switches</h3> <p>Google Chrome, as expected from the Service Worker API and whole Progressive Web Apps ideas main proponent, offers probably the richest developer tooling to ease the debugging, testing and experimenting with the APIs. Chrome's Dev Tools has a whole Application tab dedicated to PWA-related matters.</p> </div> </a> </div><div class="svelte-1itfw3h article"> <a href=/articles/opaque-responses-service-worker/ class=svelte-1itfw3h rel=prefetch> <figure> <img alt="Dealing with opaque responses in Service Worker" src=/articleimgs/phone-taking-photo-selfie.pexels.jpg class=svelte-1itfw3h loading=lazy> <figcaption class=svelte-1itfw3h>Service Worker, Offline Capabilities</figcaption> </figure> <div class="svelte-1itfw3h description"> <h3 class=svelte-1itfw3h>Dealing with opaque responses in Service Worker</h3> <p>One of the most complex and possibly annoying aspect of the offline mode implementation for Progressive Web Apps is when it needs to deal with cross-origin requests. As Service Worker is intercepting all the HTTP requests originating from our application, it means that also these reaching the external servers are to be handled, and this in turn means we need to deal with Cross-Origin Resource Sharing (CORS).</p> </div> </a> </div> <p class="svelte-nzu3si see-all text-center"> <a href=/articles/ class=button>See all</a> </p> </aside> </div> <div class="svelte-p0dnmz loader" aria-hidden=true> <div class="svelte-p0dnmz lds-ellipsis"> <div class=svelte-p0dnmz></div><div class=svelte-p0dnmz></div><div class=svelte-p0dnmz></div><div class=svelte-p0dnmz></div> </div> </div> <div class="svelte-btjd4g container" aria-label="Website footer"> <div class="text-center contact"> <h2 class=svelte-btjd4g>Get in touch</h2> <ul class=svelte-btjd4g> <li class=svelte-btjd4g><a href=mailto:hi@adambar.pl class="svelte-btjd4g icon mail-icon">Mail</a></li> <li class=svelte-btjd4g><a href=https://twitter.com/WhatWebCanDo class="svelte-btjd4g icon twitter-icon" rel="noreferrer noopener" target=_blank>Twitter</a></li> <li class=svelte-btjd4g><a href=https://linkedin.com/in/adamrbar class="svelte-btjd4g icon linkedin-icon" rel="noreferrer noopener" target=_blank>LinkedIn</a></li> <li class=svelte-btjd4g><a href=https://github.com/NOtherDev/whatwebcando class="svelte-btjd4g icon github-icon" rel="noreferrer noopener" target=_blank>GitHub</a></li> </ul> </div> <footer class=svelte-btjd4g role=contentinfo> <p class=text-left><a href=/privacy.html class=svelte-btjd4g>Privacy Policy</a></p> <p class=text-right> Created by <a href=https://adambar.pl class=svelte-btjd4g rel=noopener target=_blank>Adam Bar</a><br> Licenced under <a href=https://creativecommons.org/licenses/by-sa/4.0/ class=svelte-btjd4g rel="noreferrer noopener" target=_blank>CC-BY-SA 4.0</a> </p> </footer> </div></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,(function(a,b,c,d,e){return {article:{title:"How to use Geolocation API with Promises",slug:"use-geolocation-api-promises",html:"\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwhatwebcando.today\u002Fgeolocation.html\"\u003EGeolocation API\u003C\u002Fa\u003E is definitely one of the best known device integration APIs we have on the web, both thanks its usefulness as well as its age. It lets the apps gain access to the user&#39;s location, expressed as geo-coordinates and subscribe to its changes. The possible usages range from location-based content filtering through mapping services to city games.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"\u002Farticleimgs\u002Fbeige-map.pexels.jpg\" alt=\"How to use Geolocation API with Promises\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThe first specs were created \u003Ca href=\"https:\u002F\u002Fwww.w3.org\u002FTR\u002F2008\u002FWD-geolocation-API-20081222\u002F#geolocation_interface\"\u003Earound 2008\u003C\u002Fa\u003E and implemented by the browsers as early as 2009. The support ranges back to Internet Explorer 9 and Safari 5. Most of the API remains unchanged since then, and it can be felt nowadays, as its design even predates \u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FJavaScript\u002FGuide\u002FUsing_promises\"\u003EPromises\u003C\u002Fa\u003E – the only way APIs on the Web platform handle asynchronicity these days. Geolocation API uses almost forgotten pattern of callbacks to handle its asynchronicity – so for developers used to Promise chains it might not be obvious how to make it work together with Promise-based APIs.\u003C\u002Fp\u003E\n\u003Cp\u003EFortunately, converting callback-based Geolocation API into Promise-based one requires only a simple wrapper, here in TypeScript version for type safety:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Efunction getPosition(options?: PositionOptions): Promise&lt;Position&gt; {\n    return new Promise((resolve, reject) =&gt; \n        navigator.geolocation.getCurrentPosition(resolve, reject, options)\n    );\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ENow we can use this version of Geolocation API with Promise chains. Its only parameter is now the optional \u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FAPI\u002FPositionOptions\"\u003E\u003Ccode\u003Eoptions\u003C\u002Fcode\u003E parameter\u003C\u002Fa\u003E, callbacks are replaced by Promise resolved or rejected value:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EgetPosition(options)\n  .then((position) =&gt; {\n    console.log(position);\n  })\n  .catch((err) =&gt; {\n    console.error(err.message);\n  });\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EIt can also be used with \u003Ccode\u003Easync\u003C\u002Fcode\u003E\u002F\u003Ccode\u003Eawait\u003C\u002Fcode\u003E, as it&#39;s only a syntactic sugar on top of Promises:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Etry {\n    const position = await getPosition(options);\n    console.log(position);\n} catch (err) {\n    console.error(err.message);\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EThis async block is equivalent to the pure Promise version above.\u003C\u002Fp\u003E\n\u003Cp\u003EApparently, this simple Promise-based wrapper for Geolocation API was also released as at least \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fsearch?q=geolocation%20promise\"\u003Eseveral NPM packages\u003C\u002Fa\u003E, if this is the way you prefer to import the code, although these three lines don&#39;t seem to justify adding next dependency to our project.\u003C\u002Fp\u003E\n",image:"\u002Farticleimgs\u002Fbeige-map.pexels.jpg",tags:["Geolocation"],description:"Geolocation API is definitely one of the best known device integration APIs we have on the web, both thanks its usefulness as well as its age. It lets the apps gain access to the user's location, expressed as geo-coordinates and subscribe to its changes. The possible usages range from location-based content filtering through mapping services to city games.",author:"\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fadambar.pl\"\u003EAdam Bar\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n",weight:c,source:a},otherArticles:[{title:"Progressive Web Apps – standard or buzzword?",slug:"progressive-web-apps-standard-or-buzzword",image:"\u002Farticleimgs\u002Fadult-books-business-coffee.pexels.jpg",tags:[d,b],description:"Progressive Web Apps (PWA) is modern way to build applications, including mobile ones, using purely web technologies and relying purely on the capabilities and strengths the Web platform. Historically, it was the lack of these capabilities on the Web that caused the boom of the mobile apps, using so-called \"native\" (platform-specific) development approaches.",weight:e,source:a},{title:"How to use Chrome Dev Tools Service Worker switches",slug:"use-chrome-dev-tools-switches",image:"\u002Farticleimgs\u002Fanalogue-console-control.pexels.jpg",tags:[d,b],description:"Google Chrome, as expected from the Service Worker API and whole Progressive Web Apps ideas main proponent, offers probably the richest developer tooling to ease the debugging, testing and experimenting with the APIs. Chrome's Dev Tools has a whole Application tab dedicated to PWA-related matters.",weight:e,source:a},{title:"Dealing with opaque responses in Service Worker",slug:"opaque-responses-service-worker",image:"\u002Farticleimgs\u002Fphone-taking-photo-selfie.pexels.jpg",tags:[b,"Offline Capabilities"],description:"One of the most complex and possibly annoying aspect of the offline mode implementation for Progressive Web Apps is when it needs to deal with cross-origin requests. As Service Worker is intercepting all the HTTP requests originating from our application, it means that also these reaching the external servers are to be handled, and this in turn means we need to deal with Cross-Origin Resource Sharing (CORS).",weight:c,source:a}]}}("wwcd","Service Worker",1,"PWA",2))]};if('serviceWorker' in navigator) window.addEventListener('load',function(){navigator.serviceWorker.register('/service-worker.js');});(function(){try{eval("async function x(){}");var main="/client/client.434fbab6.js"}catch(e){main="/client/legacy/client.fa58fa12.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 